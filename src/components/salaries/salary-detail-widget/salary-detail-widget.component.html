<jnt-block title="Current payroll"
           i18n-title="@@label.current_payroll"
           [width]="ui.width.fluid"
           [padding]="ui.gutter.none">
  <jnt-form [formGroup]="form">
    <jnt-stack [align]="ui.align.stretch">
      <jnt-stack [align]="ui.align.center" [gutter]="ui.gutter.small">
        <span *ngIf="!!salary.position" position>{{salary.position.title}}</span>
        <jnt-label i18n-label="@@label.hour"
                   [label]="(salary.hourRate | currency:undefined:'symbol':'1.0-0') + ' / ' + 'Hour'"
                   [icon]="ui.icons.money" [color]="ui.color.green">
        </jnt-label>
      </jnt-stack>

      <jnt-stack [orientation]="ui.orientation.horizontal" [justify]="ui.justify.between" taxes>
        <jnt-switch formControlName="taxes" i18n-label="@@label.taxes" label="Taxes"
                    [size]="ui.size.small"></jnt-switch>
        <span position>{{salary.taxes | currency:undefined:'symbol':'1.0-0'}}</span>
      </jnt-stack>

      <jnt-stack [gutter]="ui.gutter.small" [align]="ui.align.stretch" salary>

        <jnt-date-period [start]="salary.periodFrom" [end]="salary.periodTo"></jnt-date-period>

        <jnt-stack [orientation]="ui.orientation.horizontal"
                   [justify]="ui.justify.end"
                   [align]="ui.align.center">
        <span>
            {{(taxesControl.value ? salary.sum + salary.taxes : salary.sum)
          | currency:undefined:'symbol':'1.0-0'}}
          </span>
          <jnt-label [label]="salary.chargedTime | duration"
                     [color]="ui.color.purpleLight">
          </jnt-label>
        </jnt-stack>
      </jnt-stack>

      <div payroll>
        <span>
        {{(taxesControl.value ? salary.total + salary.taxes : salary.total)
          | currency:undefined:'symbol':'1.0-0'}}</span>
      </div>

      <jnt-stack [orientation]="ui.orientation.horizontal" [align]="ui.align.stretch"
                 [justify]="ui.justify.center" metrics>
        <div metric>
          <ng-template #contentBonuses>
            <jnt-stack [gutter]="ui.gutter.tiny"
                       [align]="ui.align.stretch"
                       separation>
              <jnt-stack *ngFor="let bonus of bonuses"
                         [orientation]="ui.orientation.horizontal"
                         bonus>
                <span>{{bonus.sum | currency:undefined:'symbol':'1.0-0'}}</span>
                <span>{{bonus.comment}}</span>
              </jnt-stack>
            </jnt-stack>
          </ng-template>
          <jnt-stack
            [jntPopover]="getOptions({
              contentTemplate: contentBonuses,
              title: 'Bonuses',
              scheme: ui.scheme.primary
            }, !!bonuses.length)"
            [orientation]="ui.orientation.horizontal" [gutter]="ui.gutter.small"
            [align]="ui.align.center">
            <jnt-icon like [icon]="ui.icons.like"></jnt-icon>
            <span>{{salary.bonus | currency:undefined:'symbol':'1.0-0'}}</span>
          </jnt-stack>
        </div>
        <div separator></div>
        <div metric>
          <ng-template #contentPenalties>
            <jnt-stack [orientation]="ui.orientation.vertical"
                       [gutter]="ui.gutter.tiny"
                       [align]="ui.align.stretch"
                       separation>
              <jnt-stack *ngFor="let penalty of penalties">
                <span>{{penalty.sum | currency:undefined:'symbol':'1.0-0'}}</span>
                <span>{{penalty.comment}}</span>
              </jnt-stack>
            </jnt-stack>
          </ng-template>
          <jnt-stack
            [jntPopover]="getOptions({
              contentTemplate: contentPenalties,
              title: 'Penalties',
              scheme: ui.scheme.primary
            }, !!penalties.length)"
            [orientation]="ui.orientation.horizontal" [gutter]="ui.gutter.small"
            [align]="ui.align.center">
            <jnt-icon dislike [icon]="ui.icons.dislike"></jnt-icon>
            <span>{{salary.penalty | currency:undefined:'symbol':'1.0-0'}}</span>
          </jnt-stack>
        </div>
      </jnt-stack>
    </jnt-stack>
  </jnt-form>
</jnt-block>
