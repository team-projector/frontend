# Introduction

Team projector supports i18n. Currently we have translations for:
* English (USA) **default**
* Russian

# Workflow
To add translations you need to perform the some steps.

## Step 1 - adding translation labels with ids

In your components templates add `i18n-*` attributes:
```html
<jnt-label i18n-label="@@label.hello_world"
    label="Hello world!">
</jnt-label>

<h1 i18n="@@label.hello_world">Hello world!</h1>
```

In your components classes you should use:
```typescript
const message = $localize`:@@label.hello_world:Hello world!`}
```

We use special **labels** naming conventions `<label_type>.<snake_case_label>`:
* `label.hello_wourld` - words, small phrases
* `message.mandatory_field` - sentences
* `actions.user_signin` - verbs, what it can be clicked, moved, etc.

## Step 2 - generating translation `*.xlf` files

Run command in terminal
```
ng xi18n
```
It will make `messages.xlf` file at `src/locale` folder with text for translation based on all **i18n** ids in project.
Open you translation file, you will see blocks likes this one:
```xml
<trans-unit id="label.hello_world" datatype="html">
  <source>Hello world!</source>
  ...
</trans-unit>
```
**Step 3**

Install `ngx-i18nsupport` by runing command:
`npm install -g ngx-i18nsupport`

This will install a script called xliffmerge. You can read more about it [here](https://github.com/martinroob/ngx-i18nsupport/tree/master/projects/xliffmerge).

You can then integrate the script in your angular i18n workflow, typically in the `package.json` script section:
```json
"scripts": [
  ...
  "extract-i18n": "ng xi18n --output-path src/locale && xliffmerge --profile xliffmerge.json en de"
 ]
```
And then you need to add `xliffmere` configuration to `package.json`:
```json
{
  "xliffmergeOptions": {
    "srcDir": "src/locale",
    "genDir": "src/locale",
    "i18nFile": "messages.xlf",
    "i18nBaseFile": "messages",
    "i18nFormat": "xlf",
    "encoding": "UTF-8",
    "defaultLanguage": "en",
    "languages": ["en", "de"],
    "removeUnusedIds": true,
    "supportNgxTranslate": false,
    "ngxTranslateExtractionPattern": "@@|ngx-translate",
    "useSourceAsTarget": true,
    "targetPraefix": "",
    "targetSuffix": "",
    "beautifyOutput": false,
    "preserveOrder": true,
    "allowIdChange": false,
    "autotranslate": false,
    "apikey": "",
    "apikeyfile": "",
    "verbose": false,
    "quiet": false
  }
}
```
You can change or add languages you need by changing `"languages": ["en", "de"],`.

**Step 4**

Now you can run command for creating translation file for you language. Example for `de`:
`xliffmerge de`
It will make copy of `messages.xlf` file  at `src/locale` renamed to `messages.de.xlf` with additional tag `<target>` near every `<source>` tag which contains source text for translation and marked by ` state="new"`.
```xml
<trans-unit id="label.hello" datatype="html">
  <source>Wellcome i18n!</source><target state="new">Welcome i18n!</target>
  ...
</trans-unit>
```
So now we have 2 files at `src/locale`. `messages.xlf` and `messages.de.xlf`
You can make more translation files by using command `xliffmerge` with other language options

**Step 5**

Now you can translate text inside `<target>` to your language 
```xml
<trans-unit id="label.hello" datatype="html">
  <source>Wellcome i18n!</source>
  <target>Willkommen i18n!</target>
  ...
</trans-unit>
```
Translate the other text nodes the same way.

**Step 6**

Add your language configuration to `angular.json / locales`:
```json
  {
  "projects": {
    "yourProject": {
      "i18n": {
        "sourceLocale": {
          "code": "en",
          "baseHref": "/en/"
        },
        "locales": {
          "de": {
            "translation": "src/locale/messages.de.xlf",
            "baseHref": "/de/"
          }
        }
      },
      ...
    }
  }
}
```
